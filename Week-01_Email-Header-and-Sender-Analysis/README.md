# Week 1 ‚Äî Email Header and Sender Analysis üì®

## Objective
This lab focused on analyzing the structure of raw email headers to trace message origin, verify sender authenticity, and identify potential signs of spoofing or compromise.

---

### üì• Inspecting the Raw Email
![Screenshot 1 ‚Äì Sample email headers](https://github.com/Mikala-Troupe/soc-level-1-labs/blob/8b6ec7e5bf6a90d6e7a6a4d1d73eca3d70fd6425/Week-01_Email-Header-and-Sender-Analysis/screenshots/Lab1Sample1.png)  
Opened the sample email file to view its full headers and message body.

![Screenshot 2 ‚Äì View in terminal](https://github.com/Mikala-Troupe/soc-level-1-labs/blob/8b6ec7e5bf6a90d6e7a6a4d1d73eca3d70fd6425/Week-01_Email-Header-and-Sender-Analysis/screenshots/Lab1SS2.png)  
Displayed the email in the terminal using the `cat` command to see the underlying HTML markup that composes the body.

![Screenshot 3 ‚Äì Locate specific header fields](https://github.com/Mikala-Troupe/soc-level-1-labs/blob/8b6ec7e5bf6a90d6e7a6a4d1d73eca3d70fd6425/Week-01_Email-Header-and-Sender-Analysis/screenshots/Lab1SS3.png)  
Used the `grep` command to extract the **From** header directly from the raw file.

![Screenshot 4 ‚Äì Open in Sublime Text](https://github.com/Mikala-Troupe/soc-level-1-labs/blob/8b6ec7e5bf6a90d6e7a6a4d1d73eca3d70fd6425/Week-01_Email-Header-and-Sender-Analysis/screenshots/Lab1SS4.png)  
Opened the same file in Sublime Text (`subl` command) for easier reading and annotation.

---

### üß© Understanding Important Header Fields
![Screenshot 5 ‚Äì Annotated header fields](https://github.com/Mikala-Troupe/soc-level-1-labs/blob/8b6ec7e5bf6a90d6e7a6a4d1d73eca3d70fd6425/Week-01_Email-Header-and-Sender-Analysis/screenshots/Lab1SS5.png)

| Header | Description / Use |
|--------|-------------------|
| **From** | Identifies the sender; document it for correlation or searches within the mail gateway. |
| **Date** | Timestamp when the message was created; helps trace the email timeline. |
| **Subject** | Acts as a fingerprint; recurring subjects can reveal campaign patterns. |
| **Message-ID** | Unique identifier generated by the first mail server. Duplicate IDs can indicate replay or malicious reuse. |
| **To** | Recipient information; useful for determining message scope and potential impact. |
| **Reply-To** | Address where replies are directed; mismatch with ‚ÄúFrom‚Äù can signal phishing or forwarding abuse. |
| **Return-Path** | The envelope sender/bounce address. Compare to ‚ÄúFrom‚Äù for inconsistencies. |
| **X-Type Headers** | Custom metadata added by providers or security filters (spam scores, auth results, etc.). |
| **X-Sender-IP / X-Originating-IP** | Often reveals the original sending IP‚Äîuseful for geolocation, IP reputation, or reverse DNS lookups. |
| **Received** | Logs each mail server hop. The chain is read **bottom ‚Üí top** to trace message flow; these are reliable because each hop is added by an MTA. Think of them as passport stamps for the email‚Äôs journey. |

---

### üåç Tracing Sender and Infrastructure
![Screenshot 6 ‚Äì WHOIS lookup on IP](https://github.com/Mikala-Troupe/soc-level-1-labs/blob/8b6ec7e5bf6a90d6e7a6a4d1d73eca3d70fd6425/Week-01_Email-Header-and-Sender-Analysis/screenshots/Lab1SS6.png)  
Ran the `whois` command on the IP address from the final **Received** header to identify the owning network.

![Screenshot 7 ‚Äì WHOIS DomainTools search](https://github.com/Mikala-Troupe/soc-level-1-labs/blob/8b6ec7e5bf6a90d6e7a6a4d1d73eca3d70fd6425/Week-01_Email-Header-and-Sender-Analysis/screenshots/Lab1SS7.png)  
Verified the same IP on **whois.domaintools.com** for registrar and organization details.

![Screenshot 8 ‚Äì Header parsed via Microsoft Header Analyzer](https://github.com/Mikala-Troupe/soc-level-1-labs/blob/8b6ec7e5bf6a90d6e7a6a4d1d73eca3d70fd6425/Week-01_Email-Header-and-Sender-Analysis/screenshots/Lab1SS8.png)  
Parsed headers through **[Microsoft Header Analyzer](https://mha.azurewebsites.net/)** for automated breakdown and visualization.

![Screenshot 9 ‚Äì MXToolbox Header Analyzer](https://github.com/Mikala-Troupe/soc-level-1-labs/blob/8b6ec7e5bf6a90d6e7a6a4d1d73eca3d70fd6425/Week-01_Email-Header-and-Sender-Analysis/screenshots/Lab1SS9.png)  
Cross-checked results with **[MXToolbox Header Analyzer](https://mxtoolbox.com/EmailHeaders.aspx)** to confirm routing paths and delays.

---

## üß≠ Lessons Learned
- Reading raw headers reveals the true sender path and bypasses deceptive display names.  
- The **Message-ID**, **Return-Path**, and **Received** chain are critical for verifying legitimacy.  
- Always compare **From**, **Reply-To**, and **Return-Path** for mismatched domains.  
- WHOIS lookups and header parsers speed up investigations but manual review remains essential.  
- Proper documentation (Date, From, Subject, Message-ID, IPs) ensures traceability in incident reports.

---

## üìö Resources and Tools
- [Email Header Package for Sublime Text](https://packagecontrol.io/packages/Email%20Header)  
- [13Cubed Email Header Repo](https://github.com/13Cubed/EmailHeader)    
- [WHOIS DomainTools](https://whois.domaintools.com/)  
- [Microsoft Header Analyzer](https://mha.azurewebsites.net/)   
- [MXToolbox Header Analyzer](https://mxtoolbox.com/EmailHeaders.aspx)
